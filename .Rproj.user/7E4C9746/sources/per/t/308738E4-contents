---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1 Data loading and checking
# 1.1 import the packages
```
library(tidyverse)
library(tmap)
library(geojsonio)
library(plotly)
library(rgdal)
library(broom)
library(mapview)
library(crosstalk)
library(sf)
library(sp)
library(spdep)
library(car)
library(fs)
library(janitor)
```
#1.2 loading the map of London wards
```
wardsmap <- dir_info(here::here("original-data", 
                                 "statistical-gis-boundaries-london", 
                                 "ESRI"))%>%
  
  dplyr::filter(str_detect(path, 
                           "London_Ward_CityMerged.shp$"))%>%
  dplyr::select(path)%>%
  
  pull()%>%
  st_read()
```
check the map
```
tmap_mode("view")
qtm(wardsmap)
```
#1.3 loading the data of all variables
loading response variable: wellbeing score
```
wardswellbeing <- read_csv(here::here("processed_data_new",
                                 "wellbeing.csv"), 
                      na = c("", "NA", "n/a"), 
                      locale = locale(encoding = 'Latin1'), 
                      col_names = TRUE)
wardsinfo <- wardsmap%>%
  left_join(.,
            wardswellbeing, 
            by = c("GSS_CODE" = "Ward Code"))%>%
  clean_names()
```
loading independent variables: household income
```
wardsincome <- read_csv(here::here("processed_data_new",
                                   "income.csv"))
wardsinfo <- wardsinfo%>%
  left_join(.,
            wardsincome, 
            by = c("gss_code" = "Code"))%>%
  clean_names()
```
loading independent variables: open space with access rate
```
wardsossrate <- read_csv(here::here("processed_data_new",
                                   "space.csv"))
wardsinfo <- wardsinfo%>%
  left_join(.,
            wardsossrate, 
            by = c("gss_code" = "Ward_GSS_CODE"))%>%
  clean_names()
```
independent variables: population density
```
wardspopden <- read_csv(here::here("processed_data_new",
                                   "density.csv"))
wardsinfo <- wardsinfo%>%
  left_join(.,
            wardspopden, 
            by = c("gss_code" = "New code"))%>%
  clean_names()
```
loading independent variables: childhood obesity
```
wardsobeschool <- read_csv(here::here("processed_data_new",
                                   "obesity.csv"))
wardsinfo <- wardsinfo%>%
  left_join(.,
            wardsobeschool, 
            by = c("gss_code" = "Code"))%>%
  clean_names()
```
check the distribution of variables on the map


## 2 Distribution and transform of the data

You can include R code in the document as follows:

```{r cars}
summary(cars)
```

## 3 OLS Regression models

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
## 4 GWR model
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
